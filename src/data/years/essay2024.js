// 2024年408真题大题数据

export const essay2024 = [
  {
    id: 41,
    subject: 'ds',
    title: '拓扑排序唯一性判定',
    score: 13,
    question: `已知有向图G采用邻接矩阵存储，类型定义如下：
typedef struct {
    int numVertices, numEdges;
    char verticesList[MAXV];
    int Edge[MAXV][MAXV];
} MGraph;

请设计算法：int uniquely(MGraph G)，判定G是否存在唯一的拓扑序列，若是则返回1，否则返回0。

要求：
(1) 给出算法的基本设计思想（4分）
(2) 根据设计思想，采用C或C++语言描述算法，关键之处给出注释（9分）`,
    answer: `【设计思想】
输出拓扑序列的过程：依次从图中选取入度为0的点进行输出。
确保拓扑序列唯一需要保证：在输出拓扑序列时，每一次有且仅有一个入度为0的顶点。
进行numVertices轮遍历，如果每轮遍历只有一个顶点的入度为0，则存在唯一拓扑序列。

【算法实现】
int uniquely(MGraph g) {
    int n = g.numVertices;
    int inDegrees[MAXV];
    
    // 计算所有顶点的入度
    for (int v = 0; v < n; v++) {
        inDegrees[v] = 0;
        for (int i = 0; i < n; i++) {
            if (g.Edge[i][v] != 0)
                inDegrees[v] += g.Edge[i][v];
        }
    }
    
    // 进行n轮拓扑删除
    for (int k = 0; k < n; k++) {
        int count0 = 0;
        int v0 = -1;
        
        for (int i = 0; i < n; i++) {
            if (inDegrees[i] == 0) {
                count0++;
                v0 = i;
            }
        }
        
        if (count0 != 1) return 0;
        
        inDegrees[v0] = -1;
        
        for (int j = 0; j < n; j++) {
            if (g.Edge[v0][j] != 0)
                inDegrees[j]--;
        }
    }
    return 1;
}`,
    tags: ['拓扑排序', '邻接矩阵', '图']
  },
  {
    id: 42,
    subject: 'ds',
    title: '散列表构造与查找',
    score: 10,
    question: `将关键字 20,3,11,18,9,14,7 依次存储到长度为11的散列表HT中，散列函数为 H(key)=(key×3)%11，H₀为初始散列地址，Hₖ=(H₀+k²)%11 为第k次冲突时探测的地址。

请回答下列问题：
(1) 画出所构造的HT，并计算HT的装填因子（6分）
(2) 给出在HT中查找关键字14的关键字比较序列（2分）
(3) 在HT中查找关键字8，确认查找失败时的散列地址是多少？（2分）`,
    answer: `【答案】
(1) 散列表HT：
地址: 0   1   2   3   4   5   6   7   8   9   10
内容: 11  -   14  7   20  -   9   -   -   3   18

装填因子 = 7/11

(2) 查找关键字14的比较序列：
H(14) = (14×3)%11 = 9，位置9是3，冲突
H₁ = (9+1)%11 = 10，位置10是18，冲突
H₂ = (9+4)%11 = 2，位置2是14，找到

比较序列：3 → 18 → 14

(3) 查找关键字8失败时的散列地址：
H(8) = (8×3)%11 = 2，位置2是14，冲突
H₁ = (2+1)%11 = 3，位置3是7，冲突
H₂ = (2+4)%11 = 6，位置6是9，冲突
H₃ = (2+9)%11 = 0，位置0是11，冲突
H₄ = (2+16)%11 = 7，位置7为空

查找失败时的散列地址是7`,
    tags: ['散列表', '哈希', '二次探测']
  },
  {
    id: 43,
    subject: 'co',
    title: '指令格式与数据通路分析',
    score: 13,
    question: `假定计算机M字长为32位，按字节编址，采用32位定长指令字。指令add、slli和lw的格式、编码和功能如图所示。

请回答下列问题：
(1) 计算机M最多有多少个通用寄存器？为什么shamt字段占5位？
(2) 执行add指令时，控制信号ALUBsrc的取值应该是什么？
(3) 执行slli指令时，控制信号Ext的取值可以是0也可以是1，为什么？
(4) 执行lw指令时，控制信号Ext、ALUctr的取值分别是什么？
(5) 若一条指令的机器码是A040 A103H，则该指令一定是lw指令，为什么？
(6) 若执行该指令时，R[01H]=FFFF A2D0H，则所读取数据的存储地址是多少？`,
    answer: `【答案】
(1) 寄存器rs1和rs2用5位表示，所以最多有2⁵=32个寄存器。
shamt表示左移位数，机器字长32位，最大移位不超过32，log₂32=5位即可表示。

(2) ALUBsrc = 0
F = 8765 4321H + 9876 5432H = 1FDB 9753H（舍去最高位进位）
OF = 1（有符号溢出）
CF = 1（有进位）

(3) slli指令的高12位（IR[31:20]）最高位为0，无论零扩展还是符号扩展，都是在高位补0，效果等价。

(4) Ext = 1（符号扩展，偏移量可正可负）
ALUctr = 000（加法运算）

(5) A040 A103H的6~0位=0000011，14~12位=010，符合lw指令编码。
add和slli的高12位都是000H，而该指令高12位为A04H，所以一定是lw指令。

(6) imm = A04H（符号扩展后为FFFF FA04H）
存储地址 = R[01H] + imm = FFFF A2D0H + FFFF FA04H = FFFF 9CD4H`,
    tags: ['指令格式', '数据通路', 'ALU', '寻址']
  },
  {
    id: 44,
    subject: 'co',
    title: '汇编指令与存储管理',
    score: 8,
    question: `对于题43中的计算机M，C语言程序P包含的语句 sum+=a[i]; 在M中对应的指令序列S如下：

slli r4, r2, 2    // R[r4] <- R[r2]<<2
add r4, r3, r4    // R[r4] <- R[r3]+R[r4]
lw r5, 0(r4)      // R[r5] <- M[R[r4]+0]
add r1, r1, r5    // R[r1] <- R[r1]+R[r5]

请回答下列问题：
(1) 写出存放数组a的首地址、变量i和sum的通用寄存器编号
(2) 已知M为小端方式，采用页式存储管理，页大小为4KB。若执行到指令序列S中第1条指令时，i=5且r1和r3的内容分别为0000 1332H和0013 DFF0H。则执行sum+=a[i]语句后，a[i]的地址、a[i]和sum的机器数分别是什么？`,
    answer: `【答案】
(1) a的首地址存放在r3（03H）
i存放在r2（02H）
sum存放在r1（01H）

(2) a[i]的地址 = 0013 DFF0H + 5×4 = 0013 E004H
a[i]的机器数 = FFFF ECDCH（小端存储）
sum的机器数 = 0000 1332H + FFFF ECDCH = 0000 000EH

页大小4KB = 2¹²B，页内地址占12位
a[i]所在页的页号 = 0013EH
数组a跨越页号0013D和0013E，至少存放在2页中`,
    tags: ['汇编代码', '虚拟页式管理', '大小端']
  },
  {
    id: 45,
    subject: 'os',
    title: '页式虚拟存储管理',
    score: 7,
    question: `某计算机按字节编址，采用页式虚拟存储管理方式，虚拟地址和物理地址的长度均为32位，页表项的大小为4字节，页大小为4MB。

进程P的页表起始虚拟地址为B8C0 0000H，被装载到从物理地址6540 0000H开始的连续主存空间中。

请回答下列问题：
(1) 若CPU在执行进程P的过程中，访问虚拟地址1234 5678H时发生了缺页异常，则该页表项的虚拟地址和物理地址分别是什么？
(2) 进程P的页表所在页的页号是什么？该页对应的页表项的虚拟地址是什么？`,
    answer: `【答案】
(1) 页大小4MB = 2²²B，页内偏移22位，页号10位
虚拟地址1234 5678H的页号 = 048H

页表项虚拟地址 = B8C0 0000H + 048H×4 = B8C0 0120H
页表项物理地址 = 6540 0000H + 048H×4 = 6540 0120H

物理地址BAB4 5678H的页框号 = 前10位 = 2EAH

(2) 页表起始虚拟地址B8C0 0000H的页号 = 前10位 = 2E3H

该页对应的页表项虚拟地址 = B8C0 0000H + 2E3H×4 = B8C0 0B8CH

页表物理地址6540 0000H的页框号 = 前10位 = 195H`,
    tags: ['虚拟页式管理', '缺页异常', '页表']
  },
  {
    id: 46,
    subject: 'os',
    title: '进程同步与信号量',
    score: 8,
    question: `在某网络系统中缓冲区B用于存放一个数据分组，对B的操作有C1、C2和C3。C1将一个数据分组写入B中，C2从B中读出一个数据分组，C3对B中的数据分组进行修改。要求B为空时才能执行C1，B非空时才能执行C2和C3。

请回答下列问题：
(1) 假设进程P1和P2均需执行C1，实现C1的代码是否为临界区？为什么？
(2) 假设B初始为空，进程P1执行C1一次，进程P2执行C2一次。请定义尽可能少的信号量。
(3) 假设B初始不为空，进程P1和P2各执行C3一次，请定义尽可能少的信号量。`,
    answer: `【答案】
(1) 是临界区。因为P1和P2都需要将数据写入共享缓冲区B，如果同时执行C1会导致数据不一致，需要互斥访问。

(2) 定义信号量：
semaphore mutex = 1;  // 互斥访问缓冲区
semaphore full = 0;   // 缓冲区是否有数据

P1() {
    wait(mutex);
    执行C1;
    signal(mutex);
    signal(full);
}

P2() {
    wait(full);
    wait(mutex);
    执行C2;
    signal(mutex);
}

(3) 定义信号量：
semaphore mutex = 1;  // 互斥访问缓冲区

P1() { wait(mutex); 执行C3; signal(mutex); }
P2() { wait(mutex); 执行C3; signal(mutex); }`,
    tags: ['进程同步', '信号量', '临界区']
  },
  {
    id: 47,
    subject: 'cn',
    title: '路由协议与BGP',
    score: 9,
    question: `假设现有互联网中的4个自治系统互连拓扑示意图如图所示。其中，AS1运行内部网关协议RIP；AS3规模较小，自治系统内任意两个主机间通信经过路由器数不超过15个；AS4规模较大，自治系统内任意两个主机间通信经过路由器数量可能超过20个。

请回答下列问题：
(1) 若仅有RIP和OSPF内部网关协议供选择，则AS4应选择哪个协议？
(2) 若AS3中的某主机向本自治系统另一主机发送1个IP分组，则该IP分组的初始TTL值应至少设置为多少？
(3) 从交换初始距离向量时刻算起，R11~R16路由器均获得到达网络210.2.4.0/24的正确路由，至少需多长时间？
(4) R44向R13通告到达网络136.5.16.0/20路由时，由BGP协议哪类会话完成？
(5) R14和R15更新路由表后，各自路由表中到达该网络路由的下一跳分别是什么？`,
    answer: `【答案】
(1) AS4应选择OSPF协议。
RIP最大跳数限制为15，超过15跳的网络不可达。AS4内部可能超过20个路由器，RIP不能正常工作。

(2) TTL至少应设置为16。
最多经过15个路由器，每经过一个路由器TTL减1，初始TTL为16时，经过15个路由器后TTL仍为1。

(3) 至少需要60秒。
RIP采用距离向量算法，每次更新信息只能传播1跳，每次传播30秒。

(4) R44→R13：通过eBGP（外部BGP）会话，使用UPDATE报文通告。
R13→R14、R15：通过iBGP（内部BGP）会话通告。

(5) BGP选路原则：最短AS路径优先。
R14离R11更近，下一跳为R11。
R15离R13更近，下一跳为R13。`,
    tags: ['路由协议', 'RIP', 'OSPF', 'BGP', 'TTL']
  }
];

export default essay2024;
